:root {
  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #0f0e17;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* a {
  font-weight: 500;
  color: #646cff;
  text-decoration: inherit;
}
a:hover {
  color: #535bf2;
} */

body {
  margin: 0;
  /* display: flex; */
  /* place-items: center; */
  /* Make body transparent so background video is visible */
  background-color: transparent;
  width: 100%;
  height: 100vh;
  /* min-width: 320px;
  min-height: 100vh; */
}

/* Background video - fixed and cover entire viewport */
#bg-video{
  position: fixed;
  inset: 0; /* top:0; right:0; bottom:0; left:0 */
  width: 100%;
  height: 100%;
  z-index: -1; /* keep behind content */
  object-fit: cover;
  pointer-events: none; /* clicks go through */
  opacity: 0.98;
}

/* Ensure root content is above background video */
#root{
  position: relative;
  z-index: 1;
}

/* h1 {
  font-size: 3.2em;
  line-height: 1.1;
} */

/* button {
  border-radius: 8px;
  border: 1px solid transparent;
  padding: 0.6em 1.2em;
  font-size: 1em;
  font-weight: 500;
  font-family: inherit;
  background-color: #1a1a1a;
  cursor: pointer;
  transition: border-color 0.25s;
}
button:hover {
  border-color: #646cff;
}
button:focus,
button:focus-visible {
  outline: 4px auto -webkit-focus-ring-color;
} */
.hover-zone {
  position: fixed;
  right: 0;
  top: 0;
  width: 1px; /* 窄窄一條邊緣感應區 */
  height: 100vh;
  z-index: 1002;
}

/* 抽屜本體 */
.drawer {
  position: fixed;
  right: -200px;
  top: 7%;
  width: 300px;
  min-width: 300px;     /* 最小寬度限制，避免在小螢幕上太窄 */
  height: 83%;
  background-color: #001e1d;
  color: #fffffe;
  transition: right 0.3s ease;
  padding: 20px;
  margin: 20px auto;
  opacity: 1; 
  border-radius: 10px;
  box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);
  z-index: 1001;
}

.drawer.open {
  right: 0;
}

.drawer.closed {
  right: -200px;
}

.chat-container {
  display: flex;
  flex-direction: column;
  height: 100%;
}

.chat-messages {
  flex: 1;
  overflow-y: auto;
  margin-bottom: 10px;
  color:#001e1d
}

.message {
  padding: 8px;
  margin: 5px 0;
  border-radius: 10px;
}

.message.user {
  background-color: #006d77;
  text-align: right;
  font-size: 20px; /* 放大字體大小，可依需求調整 */
  line-height: 1.6; /* 增加行距讓文字更易讀 */
  font-weight: 500; /* 字重稍微加粗 */
}

.message.assistant {
  background-color: #83c5be;
  text-align: left;
  font-size: 20px; /* 放大字體大小，可依需求調整 */
  line-height: 1.6; /* 增加行距讓文字更易讀 */
  font-weight: 500; /* 字重稍微加粗 */
}

.chat-input {
  display: flex;
  gap: 5px;
  transition: all 0.3s ease; /* 平滑過渡效果 */
  border-radius: 8px;
}

.chat-input input {
  flex: 1;
  padding: 8px;
  border-radius: 5px;
  border: none;
  font-size: 20px; /* 放大字體大小，可依需求調整 */
  line-height: 1.6; /* 增加行距讓文字更易讀 */
  font-weight: 500; /* 字重稍微加粗 */
}

.chat-input button {
  padding: 8px 12px;
  border: none;
  background-color: #e2a953;
  color: #ffffff;
  border-radius: 5px;
  cursor: pointer;
}
.chat-input:hover{
  transform: scale(1.1); /* 放大 */
  box-shadow: 0 0 12px rgba(229, 253, 190, 0.6); /* 光暈 */
  border: 1px solid rgba(255,255,255,0.3);   /* 半透明邊框 */
  background: rgb(16, 48, 19); /* hover 時背景更亮 */
  backdrop-filter: blur(8px);                /* 背景模糊 */
  -webkit-backdrop-filter: blur(8px); 
}

.centerarea {
      position: fixed;
      top: 50%;
      left: 3%;
      transform: translateY(-50%);
      width: 87%;
      max-width: 2000px;
      min-width: 300px;     /* 最小寬度限制，避免在小螢幕上太窄 */
      height: 85%;
      background-color: #001e1d;
      color:#fffffe;
      margin: 20px auto;
      opacity: 0.7; 
      border-radius: 20px;
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);
      z-index: 998;
      transition: width 0.3s ease;
}

.centerarea.drag-over {
  background-color: #abd1c6;
  border-color: #00aaff;
}

.centerarea.shrink {
  width: calc(88% - 220px);
}

.upload-zone {
  display: block;
  text-align: center;
  width: 100%;
  height: 100%;
  z-index: 1040;
}

.upload-zone input[type="file"] {
  margin-bottom: 10px;
  z-index: 1040;
}

.file-info {
  margin-top: 10px;
  z-index: 1040;
}
.infooff{
  display: none;
  text-align: center;
  width: 100%;
  height: 100%;
  z-index: 1040;
}
.remove-btn {
  background-color: #ff4d4d;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 4px;
  cursor: pointer;
  margin-top: 5px;
  transition: background-color 0.2s ease;
}

.remove-btn:hover {
  background-color: #cc0000;
}

.preview-area {
  margin-top: 15px;
  text-align: center;
}

.preview-img {
  max-width: 100%;
  max-height: 300px;
  border-radius: 10px;
  box-shadow: 0 0 8px rgba(0,0,0,0.2);
}


.banner {
  position: fixed;
  top: 1.5%;
  left: 3%;
  width: 95%;
  height: 60px;
  background-color: #001e1d;
  display: flex;
  justify-content: space-around;
  align-items: center;
  z-index: 1000;
  transition: height 0.3s ease;
  border-radius: 20px;
  box-shadow: -2px 0 5px rgba(0, 0, 0, 0.3);
}

/* AI 靈動島 banner */
.banner.ai-island{ display:flex; align-items:center; justify-content:flex-start; padding-left:14px; background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06)); }
.ai-island .ai-island-btn{ border:none; background:transparent; padding:6px 10px; border-radius:32px; cursor:pointer }
.ai-island .ai-island-btn:focus{ outline:3px solid rgba(124,255,200,0.15); }
.ai-island.expanded{ transform: translateY(-6px) scale(1.02); box-shadow: 0 18px 48px rgba(0,0,0,0.45) }
.banner-mouth{ transition: d 220ms ease, transform 220ms ease }
.banner-mouth.mood-happy{ transform: translateY(-2px) }
.banner-mouth.mood-thinking{ transform: translateY(1px) scaleX(0.98) }
.banner-mouth.mood-sad{ transform: translateY(4px) scaleY(0.85) }
.banner-mouth.mood-excited{ transform: translateY(-4px) scaleY(1.15) }


.banner-btn {
  background: rgba(255, 255, 255, 0.2); /* 半透明背景 */
  border-radius: 12px;                  /* 圓角 */
  backdrop-filter: blur(10px);          /* 核心：背景模糊 */
  -webkit-backdrop-filter: blur(10px);  /* Safari 支援 */
  border: 1px solid rgba(255, 255, 255, 0.3); /* 淡淡邊框 */
  box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);  /* 陰影增加層次 */
  padding: 20px;
  color: #fff;  
  padding: 10px 15px;
  font-size: 16px;
  cursor: pointer;
  transition: all 0.3s ease;
}

/* 背景切换控件 */
.bg-switcher {
  position: fixed;
  top: 30px; /* 在 banner 下方 */
  right: 10%;
  display: flex;
  gap: 8px;
  z-index: 1003;
  
}
.bg-switcher .banner-btn { padding: 8px 10px; font-size: 14px; border-radius: 10px; }
.bg-switcher .banner-btn.active { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0,0,0,0.35); }

/* Body 背景变体 */
body.bg-default {
  /* 保持透明以让背景视频可见 */
  background: transparent;
  
}
body.bg-gradient {
  background: linear-gradient(135deg, #001e1d 0%, #003b3b 50%, #006d77 100%);
}
body.bg-image {
  /* 使用 public/snowhill.jpg 作为图案背景；如果需要覆盖可在此添加渐变叠层 */
  background-image: url('/snowhill.jpg');
  background-position: center center;
  background-repeat: no-repeat;
  background-size: cover;
}

.banner-btn:hover {
  background-color: #666;
  color:#fffffe;
}

.visible {
  display: block;
}

.hidden {
  display: none;
}

.openbutt{
  position: fixed;
  right: 35px;
  top: 3%;
  filter: drop-shadow(0 0 8px #dbe1ff); /* 青色光暈 */
  transition: filter 0.3s ease;
  z-index: 2000;
}
.openbutt:hover{
  filter: drop-shadow(0 0 12px #fffcd4);
}
.cutscreen{
  position: fixed;
  right: 50%;
  top: 90%;
  filter: drop-shadow(0 0 8px #dfe9ff); /* 青色光暈 */
  transition: filter 0.3s ease;
  z-index: 2000;
}
.cutscreenoff{
  display: none;
}
.cutscreen:hover{
  filter: drop-shadow(0 0 12px #feffcd);
}

/* ---------- 中央泡泡對話框 和 靈動島效果 ---------- */

.center-overlay {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at center, rgba(0,0,0,0.25), rgba(0,0,0,0.45));
  opacity: 0;
  transition: opacity 200ms ease;
  z-index: 1900;
  pointer-events: none;
}
.center-overlay.visible {
  opacity: 1;
  pointer-events: auto;
}

.center-bubble {
  position: fixed;
  left: 53%;
  top: 50%;
  transform: translate(-50%, -50%) scale(0.9);
  min-width: 68%;
  max-width: 120vmin;
  height: min(85vh, 820px);
  /* stronger frosted glass base */
  background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.28));
  border-radius: 40px;
  padding: 16px;
  box-shadow: 0 18px 60px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.03), inset 0 16px 48px rgba(0,0,0,0.28);
  color: #fff;
  z-index: 2000;
  display: flex;
  flex-direction: column;
  gap: 12px;
  opacity: 0;
  transition: transform 250ms cubic-bezier(.2,.9,.3,1), opacity 200ms ease, box-shadow 200ms ease;
  /* stronger backdrop blur and contrast for deeper glass effect */
  -webkit-backdrop-filter: blur(14px) saturate(140%) contrast(1.02);
  backdrop-filter: blur(14px) saturate(140%) contrast(1.02);
  border: 1px solid rgba(255,255,255,0.06);
}
.center-bubble.open {
  transform: translate(-50%, -50%) scale(1);
  opacity: 1;
}
.center-bubble.closed {
  pointer-events: none;
}

.bubble-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 8px 12px;
  gap: 12px;
  border-radius: 28px;
  background: linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  transition: all 220ms ease;
  cursor: pointer;
}
.bubble-header.stretch {
  padding-left: 20px;
  padding-right: 20px;
  transform: scaleX(1.02) translateY(-1px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.3);
}
.header-left {
  display: flex;
  align-items: center;
  gap: 12px;
}
.avatar-bubble {
  width: 44px;
  height: 44px;
  background: radial-gradient(circle at 30% 30%, #9be7ff, #4ab3a6 60%);
  border-radius: 999px;
  box-shadow: 0 6px 16px rgba(16,24,32,0.6), inset 0 -6px 16px rgba(255,255,255,0.06);
}
.title {
  font-weight: 700;
  letter-spacing: 0.2px;
}
.header-right {
  opacity: 0.9;
  font-size: 13px;
  color: rgba(255,255,255,0.85);
}

.island {
  width: 64px;
  height: 40px;
  border-radius: 999px;
  display: grid;
  place-items: center;
  background: linear-gradient(90deg, #8ef0d4, #6fbf9b);
  transition: all 260ms cubic-bezier(.2,.9,.3,1);
}
.island .island-content {
  width: 46px;
  height: 28px;
  display:flex;
  align-items:center;
  justify-content:center;
}
.island .dot{
  width: 12px;
  height: 12px;
  background: white;
  border-radius: 50%;
  box-shadow: 0 6px 14px rgba(0,0,0,0.25);
}
.island.expanded{
  width: 120px;
  height: 46px;
  transform: translateY(-6px);
  background: linear-gradient(90deg, #b8ffea, #5dd4a7);
}

.chat-container { /* override to fit bubble */
  display: flex;
  flex-direction: column;
  height: calc(100% - 76px);
}
.chat-messages {
  flex: 1;
  overflow-y: auto;
  padding: 6px 4px;
  display:flex;
  flex-direction:column;
  gap:8px;
}
.message {
  padding: 12px 14px;
  max-width: 78%;
  border-radius: 18px;
  font-size: 15px;
  line-height: 1.35;
  word-break: break-word;
  box-shadow: 0 6px 18px rgba(2,6,23,0.45);
  transition: transform 160ms ease;
}
.message.user {
  align-self: flex-end;
  background: linear-gradient(180deg,#225e63,#0f8a7f);
}
.message.assistant {
  align-self: flex-start;
  background: linear-gradient(180deg,#9bd8cf,#6fbfb3);
}

.chat-input {
  display: flex;
  gap: 8px;
  align-items: center;
}
.chat-input input[type="text"] {
  flex: 1;
  padding: 12px 14px;
  border-radius: 999px;
  border: none;
  background: rgba(255,255,255,0.03);
  color: inherit;
  outline: none;
}
.chat-input button {
  padding: 10px 14px;
  border-radius: 999px;
  border: none;
  background: linear-gradient(90deg,#ffd27a,#e2a953);
  cursor: pointer;
  box-shadow: 0 8px 18px rgba(0,0,0,0.35);
}
.file-label{cursor:pointer}
.file-input{display:none}

/* 左側上傳/拍照面板 */
.left-panel{
  position: fixed;
  left: 3%;
  top: 14%;
  width: 260px;
  height: 72vh;
  /* glass effect: semi-transparent base with backdrop blur */
  background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.12));
  -webkit-backdrop-filter: blur(10px) saturate(120%);
  backdrop-filter: blur(10px) saturate(120%);
  border-radius: 16px;
  padding: 12px;
  box-shadow: 0 12px 36px rgba(0,0,0,0.5), inset 0 6px 18px rgba(255,255,255,0.02);
  border: 1px solid rgba(255,255,255,0.06);
  z-index: 1500;
  display: flex;
  flex-direction: column;
  gap: 10px;
  align-items: center;
}
.left-panel.collapsed{
  /* When `shrink` is true (central bubble open), make the left panel leaner to avoid overlap */
  width: 170px;                /* narrower */
  height: 56vh;               /* slightly shorter */
  left: 2%;                   /* nudge a bit more to the left */
  top: 16%;                   /* small vertical adjustment */
  padding: 8px;               /* reduce padding for compactness */
  border-radius: 12px;        /* slightly tighter corners */
  opacity: 0.95;              /* keep visible but subtle */
  transition: all 260ms cubic-bezier(.2,.9,.3,1);
  z-index: 1400;              /* sit below center bubble (2000) but above background */
  box-shadow: 0 10px 28px rgba(0,0,0,0.45);
}
.left-controls{ display:flex; gap:10px; align-items:center }
.left-icon{ width:40px; height:40px; cursor:pointer }
.left-icon.capture{ width:36px }
.mobile-upload-btn{ display: none; }
.left-content{ width:100%; flex:1; display:flex; flex-direction:column; gap:8px; align-items:center; justify-content:flex-start; transition: all 200ms ease; border-radius: 12px; position: relative; }
.left-content.drag-active{ background-color: rgba(100, 150, 255, 0.15); border: 2px dashed #4a90e2; box-shadow: inset 0 0 8px rgba(74, 144, 226, 0.2); }
.left-video{ width:100%; height:100%; border-radius:12px; object-fit:cover }
.upload-hint{ color:rgba(255,255,255,0.8); text-align:center; padding:8px }
.loading{ color:#ffd27a }

/* banner 波動效果 */
.banner.wave{ animation: bannerWave 700ms cubic-bezier(.2,.9,.3,1); }
@keyframes bannerWave{ 0%{ transform: translateY(0) } 30%{ transform: translateY(-6px) rotate(-0.3deg) } 60%{ transform: translateY(3px) rotate(0.2deg) } 100%{ transform: translateY(0) } }

/* 右側 AI 小表情 */

.ai-face .eye{
  width:12px;
  height:12px;
  border-radius:50%;
  position:relative;
  /* deep green base with warm amber core to give 'spark' */
  background: radial-gradient(circle at 35% 30%, rgba(255,200,80,0.98) 10%, rgba(12,92,44,0.98) 45%, rgba(3,28,14,0.95) 100%);
  box-shadow: 0 4px 10px rgba(2,20,10,0.6), inset 0 1px 3px rgba(255,255,255,0.06);
  border: 1px solid rgba(0,0,0,0.25);
}
.ai-face .eye.left{ margin-right:12px }
/* small specular highlight to simulate sunlight glint */
.ai-face .eye::after{
  content: '';
  position: absolute;
  left: 50%;
  top: 2px;
  width: 4px;
  height: 4px;
  border-radius: 50%;
  background: radial-gradient(circle, rgba(255,255,230,0.95), rgba(255,255,255,0.6));
  filter: blur(0.6px);
  opacity: 0.95;
  pointer-events: none;
}
.ai-face .mouth{
  width:36px;
  height:18px;
  border-radius:12px;
  margin-top:6px;
  /* warm, friendly mouth: soft orange -> cream */
  background: linear-gradient(180deg, rgba(255,222,180,0.98), rgba(241,140,72,0.95));
  box-shadow: inset 0 2px 6px rgba(255,255,255,0.06), 0 6px 12px rgba(240,140,72,0.12);
  border: 1px solid rgba(0,0,0,0.12);
}
.ai-face.mood-thinking{ transform: scale(0.98) rotate(-3deg); box-shadow: 0 8px 22px rgba(0,0,0,0.35) }
.ai-face.mood-happy{ transform: scale(1.06); box-shadow: 0 18px 40px rgba(0,0,0,0.55) }
.ai-face.mood-excited{ transform: scale(1.12) translateY(-4px); box-shadow: 0 24px 48px rgba(0,0,0,0.6) }
.ai-face.mood-sad{ transform: scale(0.96) translateY(2px); filter: grayscale(30%) }

/* 中央泡泡輕微擠壓 */
.center-bubble.squash{ transform: translate(-50%, -50%) scale(0.985) translateY(2px) }

/* sr-only for accessibility */
.sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); border:0 }

/* focus styles */
.icon-btn{ background:transparent; border:none; padding:6px; border-radius:8px; cursor:pointer }
.icon-btn:focus{ outline:3px solid rgba(255,210,122,0.25); box-shadow:0 6px 18px rgba(0,0,0,0.35) }
.file-label{ display:inline-block; cursor:pointer; padding:8px; border-radius:8px }
.file-label input{ position:absolute; left:-9999px }
.file-label:focus{ outline: 3px solid rgba(255,210,122,0.25) }

/* SVG 面部動畫 */
.ai-face-svg .eyeL, .ai-face-svg .eyeR{ transform-origin: center; transition: transform 200ms ease }
.ai-face-svg.mood-thinking .eyeL, .ai-face-svg.mood-thinking .eyeR{ transform: scaleY(0.6) translateY(2px) }
.ai-face-svg.mood-happy .eyeL, .ai-face-svg.mood-happy .eyeR{ transform: scale(1.05) }
.ai-face-svg.mood-excited .eyeL, .ai-face-svg.mood-excited .eyeR{ transform: scale(1.2) }
.ai-face-svg.mood-sad .eyeL, .ai-face-svg.mood-sad .eyeR{ transform: scaleY(0.8) translateY(3px) }

.ai-face-svg .mouthPath{ transition: d 220ms cubic-bezier(.2,.9,.3,1) }
.ai-face-svg.mood-happy .mouthPath{ d: path('M40,76 Q60,100 80,76') }
.ai-face-svg.mood-neutral .mouthPath{ d: path('M40,80 Q60,92 80,80') }
.ai-face-svg.mood-sad .mouthPath{ d: path('M40,92 Q60,84 80,92') }
.ai-face-svg.mood-thinking .mouthPath{ d: path('M44,82 Q60,86 76,82') }
.ai-face-svg.mood-excited .mouthPath{ d: path('M38,74 Q60,108 82,74') }

/* Robot girl specific styles */
.rg-eyes .rg-eye{ transition: transform 180ms ease }
.rg-eyes .rg-eye.left, .rg-eyes .rg-eye.right{ transform-origin: center }
.rg-eyes.blink .rg-eye{ transform: scaleY(0.2) translateY(2px) }
.ai-face-svg .rg-blush{ transition: transform 300ms ease, opacity 300ms ease }
.ai-face-svg .rg-mouth{ transition: transform 220ms cubic-bezier(.2,.9,.3,1), width 220ms ease }
.ai-face-svg.mood-happy .rg-mouth{ transform: translateY(-2px) scaleX(1.05) }
.ai-face-svg.mood-sad .rg-mouth{ transform: translateY(2px) scaleX(0.92) }
.ai-face-svg.mood-excited .rg-mouth{ transform: translateY(-4px) scaleX(1.12) }
.ai-face-svg.mood-thinking .rg-mouth{ transform: translateY(1px) scaleX(0.98) }

/* small blink animation to make the robot feel alive */
@keyframes rg-blink {
  0% { transform: scaleY(1); }
  45% { transform: scaleY(0.18); }
  55% { transform: scaleY(0.18); }
  100% { transform: scaleY(1); }
}
.ai-face-svg .rg-eye { transform-origin: center; }
.rg-eyes.blink .rg-eye { transform: scaleY(0.18); }

/* hover to brighten */
.ai-face-outer:hover .ai-face-svg{ transform: translateY(-4px) scale(1.04); transition: transform 200ms ease }

/* Cyberpunk styles */
.ai-face-svg.cyberpunk{ transition: transform 220ms ease, filter 220ms ease }
.ai-face-svg.cyberpunk .cp-eye{ transition: transform 160ms ease, opacity 220ms ease }
.ai-face-svg.cyberpunk .cp-eye-core{ transition: transform 160ms ease }
.ai-face-svg.cyberpunk .cp-mouth{ transition: transform 220ms cubic-bezier(.2,.9,.3,1), opacity 220ms ease }
.ai-face-svg.cyberpunk.mood-happy .cp-mouth{ transform: scaleX(1.12); opacity:1 }
.ai-face-svg.cyberpunk.mood-sad .cp-mouth{ transform: scaleX(0.86); opacity:0.85 }
.ai-face-svg.cyberpunk.mood-excited .cp-mouth{ transform: scaleX(1.24) translateY(-2px); opacity:1 }
.ai-face-svg.cyberpunk.mood-thinking .cp-mouth{ transform: scaleX(0.96) }

/* neon pulse on eyes */
.ai-face-svg.cyberpunk .cp-eye{ filter: drop-shadow(0 6px 18px rgba(0,255,255,0.08)); }
.ai-face-svg.cyberpunk .cp-eye.left{ animation: cp-eye-pulse 3s infinite ease-in-out; }
.ai-face-svg.cyberpunk .cp-eye.right{ animation: cp-eye-pulse 3s infinite ease-in-out 0.6s; }
@keyframes cp-eye-pulse{ 0%{ transform: scale(1); opacity:0.95 } 50%{ transform: scale(1.06); opacity:0.75 } 100%{ transform: scale(1); opacity:0.95 } }

/* subtle scanlines / glow */
.ai-face-svg.cyberpunk { filter: drop-shadow(0 10px 26px rgba(0,160,140,0.06)); }
.ai-face-svg.cyberpunk .cp-background { mix-blend-mode: screen }

/* cyberpunk SVG - mood-neutral override: elf-like palette */
.ai-face-svg.cyberpunk.mood-neutral {
  filter: drop-shadow(0 10px 26px rgba(20,120,90,0.06));
}
.ai-face-svg.cyberpunk.mood-neutral,
.ai-face-svg.cyberpunk.mood-neutral svg{

/* Add outer soft shadow and animated fireflies */
.ai-face-svg.cyberpunk.mood-neutral{
  /* stronger bottom shadow */
  box-shadow: 0 36px 80px rgba(6,40,28,0.6), 0 0 36px rgba(80,200,150,0.08) inset;
}

.ai-face-svg.cyberpunk.mood-neutral::before,
.ai-face-svg.cyberpunk.mood-neutral::after{
  content: '';
  position: absolute;
  left: 50%;
  /* place pseudo-elements lower so fireflies orbit around the bottom */
  top: 72%;
  width: 180px;
  height: 180px;
  pointer-events: none;
  border-radius: 50%;
  transform-origin: 50% 50%;
}

/* primary ring of fireflies (slower) */
.ai-face-svg.cyberpunk.mood-neutral::before{
  margin-left: -90px; margin-top: -40px; /* nudge upward relative to top:72% */
  /* fireflies concentrated below the face (positive y offsets) */
  box-shadow:
    -40px 12px 8px 2px rgba(255,238,170,0.98),
    -12px 48px 6px 2px rgba(180,255,200,0.92),
    42px 60px 6px 2px rgba(255,210,120,0.95),
    70px 28px 6px 2px rgba(200,255,190,0.88),
    56px 88px 6px 2px rgba(255,220,140,0.88),
    0px 112px 6px 2px rgba(180,255,170,0.9),
    -54px 86px 6px 2px rgba(255,240,180,0.9);
  filter: blur(2.2px);
  animation: fa-spin 10s linear infinite, fa-flicker 3.4s ease-in-out infinite;
  opacity: 1;
}

/* secondary ring (faster, sparser) */
.ai-face-svg.cyberpunk.mood-neutral::after{
  margin-left: -110px; margin-top: -50px;
  width: 260px; height: 260px;
  box-shadow:
    -110px 8px 8px 2px rgba(255,240,180,0.88),
    -8px 120px 8px 2px rgba(200,255,190,0.78),
    96px 80px 8px 2px rgba(255,210,100,0.9),
    140px 40px 8px 2px rgba(180,255,170,0.75),
    92px 148px 8px 2px rgba(255,230,150,0.78),
    -48px 168px 8px 2px rgba(220,255,200,0.72);
  filter: blur(2.6px);
  animation: fa-spin 6s linear reverse infinite, fa-flicker 4s ease-in-out infinite;
  opacity: 0.95;
}

@keyframes fa-spin{
  from { transform: translate(-50%,-50%) rotate(0deg); }
  to   { transform: translate(-50%,-50%) rotate(360deg); }
}

@keyframes fa-flicker{
  0% { opacity: 0.95; filter: blur(2px); }
  40% { opacity: 0.6; filter: blur(1.5px); }
  60% { opacity: 0.9; filter: blur(2.6px); }
  100% { opacity: 0.95; filter: blur(2px); }
}

/* Also apply visible shadow and fireflies to .ai-face and .ai-face-outer to handle non-SVG cases */
.ai-face.mood-neutral,
.ai-face-outer.mood-neutral{
  position: relative;
  z-index: 2100;
  /* stronger bottom-oriented shadow */
  box-shadow: 0 40px 100px rgba(6,48,30,0.62), 0 0 40px rgba(80,220,160,0.08) inset;
}

.ai-face.mood-neutral::before,
.ai-face-outer.mood-neutral::before,
.ai-face.mood-neutral::after,
.ai-face-outer.mood-neutral::after{
  content: '';
  position: absolute;
  left: 50%; top: 74%; /* lower placement */
  width: 160px; height: 160px;
  pointer-events: none;

/* ---------- Responsive: switch to mobile layout when viewport is narrow ---------- */
@media (max-width: 768px) {
  :root { font-size: 15px; }
  body { height: auto; }

  /* 全頁文字整體縮小（覆蓋大部分明確 px 定義的字級） */
  body, body * {
    font-size: 0.92em !important;
    line-height: 1.3 !important;
  }

/* 語言選擇與輸入框整體尺寸調整 */
.chat-input select[aria-label="選擇語言"] {
  font-size: 13px;
  padding: 4px 6px;
  border-radius: 6px;
  height: 34px;
}

.txtinputplace {
  flex: 1 1 auto; /* 讓輸入框占用剩餘空間 */
  min-width: 160px;
  font-size: 16px; /* 放大輸入文字 */
  padding: 10px 12px;
  height: 44px;
  border-radius: 16px;
}

@media (max-width: 768px) {
  .chat-input select[aria-label="選擇語言"] { font-size: 12px; padding: 3px 6px; height: 32px; }
  .txtinputplace { font-size: 15px; height: 40px; }
}

@media (max-width: 420px) {
  .chat-input select[aria-label="選擇語言"] { font-size: 11px; padding: 2px 5px; height: 30px; }
  .txtinputplace { font-size: 14px; height: 38px; }
}

  /* Banner stretch full width and reduce height */
  .banner {
    left: 0;
    top: 0.5%;
    width: 100%;
    height: 56px;
    border-radius: 0 0 12px 12px;
    padding: 8px 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .banner-btn { padding: 8px 10px; font-size: 14px; }

  /* Hide left-side upload panel on small screens to preserve space */
  .left-panel { display: none; }

  /* Make center area occupy most of the screen under the banner */
  .centerarea {
    position: fixed;
    top: 64px;
    left: 4%;
    transform: none;
    width: 92%;
    height: calc(100vh - 64px - 160px);
    min-width: auto;
    border-radius: 12px;
    padding: 12px;
  }

  /* Drawer becomes bottom sheet full width */
  .drawer {
    right: -100%;
    left: 0;
    bottom: 0;
    top: auto;
    width: 100%;
    min-width: auto;
    height: 40vh;
    border-radius: 12px 12px 0 0;
    margin: 0;
    box-shadow: 0 -8px 30px rgba(0,0,0,0.5);
    transition: right 0.25s ease, transform 0.25s ease;
  }
  .drawer.open { right: 0; transform: translateY(0); }

  /* Center bubble and chat adapt to narrower width */
  .center-bubble {
    left: 50%;
    top: 60%;
    transform: translate(-50%, -50%);
    width: 96%;
    max-width: none;
    height: auto;
    max-height: calc(100vh - 140px);
    border-radius: 16px;
    padding: 10px;
  }

  .chat-messages { padding: 6px; }
  /* Shrink message font and bubble spacing for mobile */
  .message { max-width: 86%; font-size: 15px; padding: 8px 10px; }
  .message.user, .message.assistant { font-size: 15px; }

  /* Shrink titles and headings */
  .title { font-size: 15px; }

  /* Chat input: tighten spacing, smaller font and buttons for mobile */
  .chat-input {
    gap: 6px;
    align-items: center;
  }
  .chat-input input[type="text"], .chat-input input {
    font-size: 13px;
    padding: 8px 10px;
    border-radius: 14px;
    height: 38px;
  }
  .chat-input button {
    font-size: 13px;
    padding: 6px 8px;
    border-radius: 12px;
    height: 36px;
    min-width: 44px;
  }

  /* Specific mobile shrink rules for mic, text input placeholder area, and send button */
  .mic-button {
    width: 10px;
    height: 36px;
    padding: 6px;
    font-size: 5px;
  }
  .txtinputplace {
    font-size: 5px;
    padding: 4px 6px;
    height: 36px;
  }
  .ai_txt_sendbutton {
    font-size: 5px;
    padding: 6px 8px;
    height: 36px;
    min-width: 44px;
  }

  /* General buttons and controls */
  .banner-btn { font-size: 14px; padding: 8px 10px; }
  .remove-btn { font-size: 14px; padding: 6px 10px; }
  .file-label { font-size: 14px; padding: 6px 8px; }
  .left-icon { width: 34px; height: 34px; }

  .bg-switcher { right: 6%; top: 74px; }
  .openbutt { right: 12px; top: 8px; transform: none; }

  /* Make background video focus on top for mobile crop */
  #bg-video { object-position: center top; }
}

/* Extra small phones: tighten spacing and increase drawer height for easier tapping */
@media (max-width: 420px) {
  :root { font-size: 14px; }
  /* 更進一步整頁文字縮小，讓手機顯示更緊湊 */
  body, body * {
    font-size: 0.88em !important;
    line-height: 1.25 !important;
  }
  .drawer { height: 48vh; }
  .banner { height: 52px; padding: 6px 10px; }
  .banner-btn { font-size: 13px; padding: 6px 8px; }
  .message { font-size: 14px; padding: 8px; }
  .chat-input { gap: 4px; }
  .chat-input input[type="text"], .chat-input input { font-size: 13px; padding: 7px 10px; height: 36px; }
  .chat-input button { padding: 6px 8px; font-size: 12px; height: 34px; min-width: 40px; }
  .remove-btn { font-size: 13px; padding: 8px 10px; }
  .file-label { font-size: 13px; }

  /* Extra small screen: make mic/send/input even tighter */
  .mic-button { width: 5px; height: 5px; padding: 2px; font-size: 5px; }
  .txtinputplace { font-size: 5px; padding: 6px 6px; height: 34px; }
  .ai_txt_sendbutton { font-size: 5px; padding: 5px 6px; height: 34px; min-width: 38px; }
}
  border-radius: 50%;
  transform-origin: 50% 50%;
}

.ai-face.mood-neutral::before,
.ai-face-outer.mood-neutral::before{
  margin-left: -80px; margin-top: -36px;
  box-shadow:
    -36px 8px 8px 2px rgba(255,238,170,0.98),
    -10px 48px 6px 2px rgba(170,255,190,0.92),
    36px 60px 6px 2px rgba(255,200,110,0.95),
    62px 28px 6px 2px rgba(190,255,200,0.88),
    48px 88px 6px 2px rgba(255,210,130,0.88),
    0px 120px 6px 2px rgba(170,255,160,0.9),
    -40px 88px 6px 2px rgba(255,240,180,0.9);
  filter: blur(2.2px);
  animation: fa-spin 9s linear infinite, fa-flicker 3.4s ease-in-out infinite;
  opacity: 1;
}

.ai-face.mood-neutral::after,
.ai-face-outer.mood-neutral::after{
  margin-left: -100px; margin-top: -48px;
  width: 240px; height: 240px;
  box-shadow:
    -100px 12px 8px 2px rgba(255,240,180,0.88),
    -6px 140px 8px 2px rgba(180,255,190,0.78),
    92px 80px 8px 2px rgba(255,200,90,0.9),
    116px 48px 8px 2px rgba(180,255,170,0.75),
    84px 136px 8px 2px rgba(255,230,140,0.78),
    -42px 168px 8px 2px rgba(220,255,200,0.72);
  filter: blur(2.6px);
  animation: fa-spin 6.5s linear reverse infinite, fa-flicker 4s ease-in-out infinite;
  opacity: 0.95;
}

@media (prefers-reduced-motion: reduce){
  .ai-face-svg.cyberpunk.mood-neutral::before,
  .ai-face-svg.cyberpunk.mood-neutral::after,
  .ai-face.mood-neutral::before,
  .ai-face.mood-neutral::after,
  .ai-face-outer.mood-neutral::before,
  .ai-face-outer.mood-neutral::after{
    animation: none;
    opacity: 0.9;
    filter: blur(1.6px);
  }
}
  border-radius: 999px; /* make circular */
  overflow: hidden;
  display: inline-block;
  transform-origin: center;
  transform: scale(1.02); /* slight scale to feel rounder */
  transition: transform 220ms ease, border-radius 220ms ease;
}
.ai-face-svg.cyberpunk.mood-neutral .cp-background{
  /* soft pale green background for the face */
  fill: #dff7ef;
  mix-blend-mode: screen;
}
.ai-face-svg.cyberpunk.mood-neutral .cp-eye{
  /* deep green outer */
  fill: #0b4e2b;
  filter: drop-shadow(0 6px 12px rgba(8,40,24,0.28));
}
.ai-face-svg.cyberpunk.mood-neutral .cp-eye-core{
  /* warm amber core */
  fill: #ffcd75;
}
.ai-face-svg.cyberpunk.mood-neutral .cp-eye::after,
.ai-face-svg.cyberpunk.mood-neutral .cp-eye-core::after{
  /* if eyes are represented as DOM elements, add highlight via pseudo; for SVG, prefer a small circle element */
  display: none; /* placeholder - highlights should be placed in SVG markup when possible */
}
.ai-face-svg.cyberpunk.mood-neutral .cp-mouth{
  /* warm mouth - cream to soft orange */
  fill: #f4d9b8;
  opacity: 0.98;
}

/* nudge the SVG face slightly to the right when in mood-neutral */
.ai-face-svg.cyberpunk.mood-neutral{
  position: relative;
  top: 15px;
  left: 22%; /* move right by 10px; adjust value as needed */
  transition: left 500ms ease, filter 220ms ease;
}


/* Responsive: 小於 600px 時把左側 panel 收納為底部抽屜 */
@media (max-width: 600px){
  .left-panel{ left: 50%; transform: translateX(-50%); bottom: 0; top: auto; width: 100%; height: 220px; border-radius: 12px 12px 0 0; }
  .center-bubble{ top: 50%; height: 60vh; max-height: 86vh; width: calc(100% - 32px); left: 50%; transform: translate(-50%, -50%) scale(0.98); }
  .ai-face-outer{ right: 16px; top: 6%; }
  /* Show a compact upload button in left-controls for mobile users */
  .mobile-upload-btn{ display:inline-flex !important; align-items:center; justify-content:center; padding:6px; border-radius:10px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); box-shadow: 0 6px 14px rgba(0,0,0,0.32); }
  .mobile-upload-btn .left-icon{ width:28px; height:28px; }
  /* Mobile: shrink and center the roundtable discussion area */
  .roundtable-card{ width: min(420px, 92%); max-height: 90vh; border-radius: 14px; padding: 8px; }
  .roundtable-center{
    position: relative !important;
    top: 0 !important;
    left: 50% !important;
    transform: translate(-50%, 0) !important;
    width: 92% !important;
    max-width: 380px !important;
    height: auto !important;
    padding: 8px !important;
    border-radius: 12px !important;
    display: flex !important;
    flex-direction: column !important;
    align-items: center !important;
    justify-content: flex-start !important;
  }
  .roundtable-center .center-text{ width:100% !important; height: 260px !important; max-height: 70vh !important; padding:8px !important; box-sizing: border-box; }
  .roundtable-agents{ top: 8px !important; left: 50% !important; transform: translateX(-50%) !important; }
  .agent-node{ width: 88px !important; height: 88px !important; }
  .agent-node img{ width: 88px !important; height: 88px !important; }
  .agent-node .name{ top: 58px !important; font-size: 11px !important; width: 100px !important; }
}

/* 拍照模式伸展：左側 panel 伸展到中間並把中間泡泡挤压 */
.left-panel.expanded{
  left: 50%; transform: translateX(-50%); width: min(720px, 92%); height: 78vh; top: 8%; border-radius: 28px; z-index: 2100; transition: all 320ms cubic-bezier(.2,.9,.3,1);
}
.center-bubble.compressed{
  transform: translate(-50%, -50%) scale(0.94); box-shadow: 0 8px 26px rgba(2,6,23,0.55); transition: transform 320ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease;
}
.ai-face-outer[aria-hidden="true"]{ opacity: 0; transform: translateY(-8px) scale(0.9); pointer-events: none; transition: all 260ms ease }
.ai-face-outer{ transition: all 260ms ease }

/* Additional AI face animations and small emoji bubble */
.ai-face {
  transform-origin: center;
}
.ai-face.pop {
  animation: ai-pop 420ms cubic-bezier(.2,.9,.3,1);
}
.ai-face .expression {
  position: absolute;
  top: -8px;
  right: -5px;
  min-width: 26px;
  height: 26px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,0.95);
  border-radius: 50%;
  box-shadow: 0 4px 8px rgba(0,0,0,0.12);
  font-size: 14px;
  padding: 4px;
  transform-origin: center;
  animation: float 2.6s ease-in-out infinite;
  pointer-events: none;
}
.ai-face.happy .expression { background: #fffbe6; }
.ai-face.sad .expression { background: #eef6ff; }
.ai-face.thinking .expression { background: #fff7f0; }
.ai-face.excited .expression { background: #fff0ff; }

/* blink effect controlled by .blink on the container */
.ai-face.blink img {
  transform: scaleY(0.14);
  transition: transform 120ms ease;
}

.ai-face img {
  border-radius: 8px;
  will-change: transform;
  animation: subtle-bob 6s ease-in-out infinite;
}

@keyframes ai-pop {
  0% { transform: scale(1); }
  40% { transform: scale(1.12); }
  70% { transform: scale(0.98); }
  100% { transform: scale(1); }
}

@keyframes float {
  0% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
  100% { transform: translateY(0); }
}

@keyframes subtle-bob {
  0% { transform: translateY(0) rotate(0.0deg); }
  50% { transform: translateY(-3px) rotate(0.2deg); }
  100% { transform: translateY(0) rotate(0.0deg); }
}

/* Bubble flow animations when message sent */
.bubbles-overlay {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 2500;
  --origin-x: 50%;
  --origin-y: 50%;
}
.bubbles-container {
  position: absolute;
  left: var(--origin-x);
  top: var(--origin-y);
  transform: translate(-50%, -50%);
}
.bubble-agent {
  position: absolute;
  width: 72px;
  height: 72px;
  border-radius: 999px;
  display:flex; align-items:center; justify-content:center;
  background: linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.92));
  box-shadow: 0 12px 36px rgba(0,0,0,0.28);
  transform-origin: center;
  opacity: 0;
}
.bubble-agent img{ width:48px; height:48px; border-radius:8px }
.bubble-agent .btext{ position:absolute; bottom:-26px; left:50%; transform:translateX(-50%); background:rgba(0,0,0,0.66); color:#fff; padding:6px 10px; border-radius:14px; font-size:12px; white-space:nowrap; opacity:0 }

/* launch: pop out from center and orbit then swoop away */
@keyframes bubble-launch {
  0% { transform: translate(0,0) scale(0.2); opacity: 0 }
  20% { transform: translate(0,0) scale(1); opacity: 1 }
  60% { transform: translate(var(--tx, 0px), var(--ty, 0px)) scale(1); opacity: 1 }
  100% { transform: translate(calc(var(--tx, 0px) * 1.6), calc(var(--ty, 0px) * 1.6)) scale(0.6); opacity: 0 }
}

@keyframes bubble-orbit {
  0% { transform: rotate(0deg) translateX(0) rotate(0deg) }
  50% { transform: rotate(180deg) translateX(8px) rotate(-180deg) }
  100%{ transform: rotate(360deg) translateX(0) rotate(-360deg) }
}

.bubble-agent.show {
  animation: bubble-launch 10s cubic-bezier(.2,.9,.3,1) forwards;
}
.bubble-agent.show .btext{ animation: fade-in-out 10s ease forwards 0.3s }

@keyframes fade-in-out{ 0%{ opacity:0 } 10%{ opacity:1 } 85%{ opacity:1 } 100%{ opacity:0 } }

/* small orbital wobble while visible */
.bubble-agent .orb { animation: bubble-orbit 2.8s linear infinite }


/* 右侧装饰 */
.right-decor{
  position: fixed;
  right: 18px;
  top: 12%;
  width: 200px;
  height: 72vh;
  z-index: 900;
  pointer-events: none;
  opacity: 0.95;
}
.decor-svg{ width:100%; height:100%; display:block }
.bubbles circle{ transform-origin: center; transition: transform 600ms ease, opacity 420ms ease }
.bubbles .b1{ animation: floaty 8s infinite ease-in-out; }
.bubbles .b2{ animation: floaty 10s infinite ease-in-out 0.8s; }
.bubbles .b3{ animation: floaty 12s infinite ease-in-out 0.4s; }
.bubbles .b4{ animation: floaty 9s infinite ease-in-out 0.2s; }
.bubbles .b5{ animation: floaty 11s infinite ease-in-out 0.6s; }
.streaks ellipse{ filter: blur(6px); transition: opacity 400ms ease }

@keyframes floaty{
  0%{ transform: translateY(0) scale(1); opacity: 0.9 }
  50%{ transform: translateY(-12px) scale(1.03); opacity: 0.75 }
  100%{ transform: translateY(0) scale(1); opacity: 0.9 }
}

@media (prefers-reduced-motion: reduce){
  .bubbles circle{ animation: none !important; transform:none !important }
}

/* 按下送出或訊息來時的輕微擠壓動畫 */
.center-bubble.squash {
  transform: translate(-50%, -50%) scale(0.985) translateY(2px);
}

/* 背景泡泡裝飾（純CSS，非DOM） */
.center-bubble::before,
.center-bubble::after{
  content: '';
  position: absolute;
  border-radius: 999px;
  filter: blur(34px);
  opacity: 0.16; /* stronger glow */
  pointer-events: none;
}
.center-bubble::before{
  width: 260px;
  height: 260px;
  left: -72px;
  top: -52px;
  background: radial-gradient(circle at 30% 30%, rgba(111,240,209,0.18), rgba(47,164,138,0.14));
}
.center-bubble::after{
  width: 360px;
  height: 360px;
  right: -96px;
  bottom: -96px;
  background: radial-gradient(circle at 70% 70%, rgba(155,216,207,0.16), rgba(74,139,116,0.12));
}

/* a subtle inner overlay to darken and add depth */
/* note: inner overlay implemented via inset box-shadow above for broader browser support */

@media (max-width: 768px) {
      .rectangle {
        width: 80%;          /* 平板或小螢幕時放寬寬度 */
      }
}

@media (max-width: 480px) {
      .rectangle {
        width: 95%;          /* 手機螢幕幾乎全寬 */
      }
}


@media (prefers-color-scheme: light) {
  :root {
    color: #213547;
    background-color: #ffffff;
  }
  a:hover {
    color: #747bff;
  }
  button {
    background-color: #f9f9f9;
  }
}

/* Intro sprite overlay */
.intro-overlay{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.45); /* dim the page */
  display:flex;
  align-items:center;
  justify-content:center;
  z-index: 3000;
  animation: intro-fade-in 240ms ease;
}

.intro-sprite{ text-align:center; color:#fff; max-width:420px; padding:18px; border-radius:16px }
.sprite-img{ width:140px; animation: sprite-float 3s ease-in-out infinite; cursor:pointer; transition: transform 260ms ease }
.sprite-img.clicked{ transform: scale(1.12) rotate(6deg) }
.sprite-message{ margin-top:14px; font-size:18px; line-height:1.4; font-weight:600; color:#fff; text-shadow:0 6px 20px rgba(0,0,0,0.6) }

@keyframes sprite-float{ 0%{ transform: translateY(0) } 50%{ transform: translateY(-18px) } 100%{ transform: translateY(0) } }
@keyframes intro-fade-in{ from{ opacity:0 } to{ opacity:1 } }


/* Center overlay chat (WeChat-like) */
.center-overlay-chat {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 2001;
  pointer-events: none; /* allow clicks through except card */
}
.center-overlay-chat .chat-card {
  pointer-events: auto;
  width: 480px;
  max-width: calc(100% - 48px);
  background: rgba(10,12,18,0.9);
  border-radius: 12px;
  padding: 12px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.6);
}
.center-overlay-chat .chat-card-messages { max-height: 60vh; overflow-y: auto; display:flex; flex-direction:column; gap:8px; }
.chat-messages, .center-overlay-chat .chat-card-messages { scroll-behavior: smooth; }
.overlay-message { display: flex; flex-direction: column; max-width: 78%; }
.overlay-message.user { align-self: flex-end; text-align: right; }
.overlay-message.agent { align-self: flex-start; text-align: left; }
.overlay-sender { font-size: 12px; color: #9aa5b1; margin-bottom: 4px; }
.overlay-text { padding: 10px 12px; border-radius: 14px; font-size: 14px; line-height: 1.4; transform-origin: center; animation: pop-in 320ms cubic-bezier(.2,.9,.3,1) both; }
.overlay-message.user .overlay-text { background: linear-gradient(135deg,#3b82f6,#2563eb); color: #fff; }
.overlay-message.agent .overlay-text { background: rgba(255,255,255,0.06); color: #e6eef6; }

@media (max-width: 520px) {
  .center-overlay-chat .chat-card { width: calc(100% - 24px); }
}

/* pop-in animation for overlay texts */
@keyframes pop-in {
  0% { transform: translateY(8px) scale(.98); opacity: 0 }
  60% { transform: translateY(-6px) scale(1.02); opacity: 1 }
  100% { transform: translateY(0) scale(1); opacity: 1 }
}

.center-overlay-chat .chat-card-header {
  font-weight: 700;
  color: #e6f7ff;
  padding: 8px 12px;
  font-size: 14px;
  border-bottom: 1px solid rgba(255,255,255,0.04);
  margin-bottom: 8px;
}


.roundtable-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 80;
  pointer-events: auto;
}

.roundtable-card {
  position: absolute;
  border-radius: 20%;
  background: rgba(255, 255, 255, 0.96);
  width: min(760px, 92%);
  max-height: 86vh;
  display: flex;
  align-items: center;
  justify-content: center;
}

.center-title {
  border-radius: 20%;
  background: rgba(255, 255, 255, 0.96);
  color: #000000;
  font-size: 30;
  font-weight: bold;
}

.roundtable-center {
  position: absolute;
  top: -500px;
  left: -150px;
  width: 1250px;
  height: 945px;
  border-radius: 50%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 20px;
  text-align: center;
}

.roundtable-center .center-text {
  border-radius: 10%;
  background: rgba(200, 200, 200, 0.6);
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.3);
  width: 80%;
  height: 80%;
  overflow: auto;
  padding: 8px;
  text-align: left;
}

/* hide scrollbar but keep scroll functionality */
.roundtable-center .center-text::-webkit-scrollbar {
  width: 0;
  height: 0;
}
.roundtable-center .center-text {
  -ms-overflow-style: none;
  scrollbar-width: none;
}

/* message layout and entrance animations */
.rt-message {
  display: flex;
  align-items: flex-start;
  gap: 8px;
  width: 100%;
  max-width: 720px;
  box-sizing: border-box;
}
.rt-avatar {
  width: 40px;
  flex-shrink: 0;
}
.rt-body {
  flex: 1;
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}
.rt-sender {
  font-size: 12px;
  color: #333;
  margin-bottom: 6px;
}

/* floating sender name near avatar */
.rt-sender-floating {
  position: absolute;
  font-size: 12px;
  color: #222;
  background: rgba(255, 255, 255, 0.92);
  padding: 4px 8px;
  border-radius: 8px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
  pointer-events: none;
}
.msg-left .rt-sender-floating {
  transform-origin: left center;
  left: 56px;
  top: -6px;
  animation: nameSlideLeft 420ms cubic-bezier(.2, .9, .2, 1) both;
}
.msg-right .rt-sender-floating {
  transform-origin: right center;
  right: 56px;
  top: -6px;
  animation: nameSlideRight 420ms cubic-bezier(.2, .9, .2, 1) both;
}

@keyframes nameSlideLeft {
  from { opacity: 0; transform: translateX(-10px) scale(.98); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}
@keyframes nameSlideRight {
  from { opacity: 0; transform: translateX(10px) scale(.98); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}

.center-message {
  background: rgba(250, 250, 250, 0.9);
  padding: 10px 12px;
  border-radius: 12px;
  display: inline-block;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
  color: #000000;
}

/* left / right variants */
.msg-left {
  justify-content: flex-start;
  transform-origin: left center;
  animation: slideInLeft 360ms cubic-bezier(.2, .9, .2, 1) both;
}
.msg-right {
  justify-content: flex-end;
  flex-direction: row-reverse;
  transform-origin: right center;
  animation: slideInRight 360ms cubic-bezier(.2, .9, .2, 1) both;
}

@keyframes slideInLeft {
  from { opacity: 0; transform: translateX(-26px) scale(0.98); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}
@keyframes slideInRight {
  from { opacity: 0; transform: translateX(26px) scale(0.98); }
  to { opacity: 1; transform: translateX(0) scale(1); }
}

.roundtable-agents {
  position: absolute;
  inset: 0;
  pointer-events: none;
  top: 75px;
  left: 110%;
}

/* agent node */
.agent-node {
  position: absolute;
  width: 200px;
  height: 200px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: transform 300ms cubic-bezier(.2, .9, .2, 1), box-shadow 300ms, filter 300ms;
  pointer-events: auto;
  z-index: 2;
  transform: translate(-50%, -50%);
}
.agent-node img {
  width: 200px;
  height: 200px;
  border-radius: 50%;
  object-fit: cover;
  display: block;
}

.agent-node .name {
  position: absolute;
  top: 98px;
  width: 140px;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  font-size: 12;
}

.ai_txt_sendbutton {
  margin-left: 1px;
  padding: 4x 8x;
  border-radius: 10%;
  border: 1px solid rgba(0,0,0,0.03);
  background-color: #a1c423;   /* 改成 background-color */
  font-size: 18px;
  font-weight: bold;
  transition: all 0.3s ease;
}

.ai_txt_sendbutton:hover {
  transform: scale(1.1);
  box-shadow: 0 0 12px rgba(161,196,35,0.6);
}

.ai_txt_sendbutton:active {
  background-color: #2ecc71;   /* 按下時變綠色 */
}

.txtinputplace {
  transition: all 0.3s ease;
}
.txtinputplace:hover{
  background-color: #fff7f0 ;
  box-shadow: 0 0 12px rgba(207, 255, 36, 0.6);
}

.voicecontroltxtweb {
  position: fixed;
  right: 40px;
  bottom: 40px;
  z-index: 240;
  padding: 8px 12px;
  border-radius: 12px;
  border: 1px solid rgba(0,0,0,0.12);
  background-color: #4ade80; /* 預設綠色 */
  box-shadow: 0 12px 30px rgba(0, 0, 0, 0.25);
  font-size: 16px;
  font-weight: bold;
  transition: all 0.3s ease;
}

/* hover 效果 */
.voicecontroltxtweb:hover {
  transform: scale(1.40); /* 放大 */
  box-shadow: 0 0 20px rgba(188, 255, 31, 0.8); /* 光暈 */
  background-color: #22c55e; /* 顏色變亮 */
}

/* ---------- Suggestion Bar (建議問題列) ---------- */
.suggestion-bar{
  display:flex;
  gap:8px;
  align-items:center;
  padding:8px 12px;
  overflow-x:auto;
  width:100%;
  -webkit-overflow-scrolling: touch;
}
.suggestion-chip{
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.06));
  color: #e9f7f2;
  border: 1px solid rgba(255,255,255,0.04);
  padding:8px 12px;
  border-radius: 999px;
  font-size: 14px;
  cursor:pointer;
  white-space:nowrap;
  transition: transform 160ms ease, box-shadow 160ms ease, background 160ms ease;
}
.suggestion-chip:focus,
.suggestion-chip:hover{
  transform: translateY(-2px) scale(1.02);
  box-shadow: 0 10px 24px rgba(0,0,0,0.45);
  outline: none;
}
.chip-icon{ margin-right:8px; display:inline-flex; align-items:center; }
.chip-loading{ margin-left:8px; opacity:0.9 }

@media (max-width: 600px){
  .suggestion-bar{ padding:6px 8px; gap:6px }
  .suggestion-chip{ font-size:13px; padding:6px 10px }
}


.header-centualtxt {
  width: 80%;
  height: 40px;

/* Move center-bubble down and shrink center-text on mobile */
@media (max-width: 768px) {
  .center-bubble.open {
    top: 80% !important;
    transform: translate(-50%, -36%) !important; /* move further down */
  }
  /* shrink roundtable/center text area further */
  .center-text {
    font-size: 14px !important;
    padding: 4px !important;
    max-width: 90% !important;
  }
}

@media (max-width: 420px) {
  .center-bubble.open {
    top: 80% !important;
    transform: translate(-50%, -34%) !important;
  }
  .center-text {
    font-size: 13px !important;
    padding: 4px !important;
    max-width: 96% !important;
  }
}
  overflow: hidden;
  position: relative;
  background: transparent;   /* 背景透明 */
  border: none;              /* 移除邊框（可選） */
  display: flex;
  align-items: center;
}

.scroll-container {
  width: 100%;
  white-space: nowrap;
}

.scroll-text {
  display: inline-block;
  animation: scroll-left 65s linear infinite;
}

.scroll-text span {
  display: inline-block;
  margin-right: 50px; /* 每條提示之間的間距 */
  font-size: 18px;
  font-weight: bold;
}

@keyframes scroll-left {
  0% {
    transform: translateX(100%);
  }
  100% {
    transform: translateX(-100%);
  }
}

/* 强制性的手机端覆盖（放在文件末尾，优先级高于早期声明） */
@media (max-width: 768px) {
  .mic-button, .ai_txt_sendbutton, .txtinputplace {
    font-size: 12px !important;
    padding: 6px 8px !important;
    height: 36px !important;
    min-width: 40px !important;
  }
  .mic-button { width: 36px !important; }
}

@media (max-width: 420px) {
  .mic-button, .ai_txt_sendbutton, .txtinputplace {
    font-size: 5px !important;
    padding: 5px 6px !important;
    height: 34px !important;
    min-width: 36px !important;
  }
  .mic-button { width: 32px !important; }
}

/* 强制缩小页面上所有按钮与控制在手机断点，并把 mic 长度设为 60px */
@media (max-width: 768px) {
  /* mic length 60px */
  .mic-button { width: 60px !important; height: 36px !important; }

  /* 通用按钮缩小 */
  button, .banner-btn, .remove-btn, .ai_txt_sendbutton, .voicecontroltxtweb, .openbutt, .bg-switcher .banner-btn {
    font-size: 9px !important;
    padding: 6px 8px !important;
    height: 36px !important;
    border-radius: 8px !important;
    min-width: 44px !important;
  }

  /* 背景切换控件与语音控制进一步调整 */
  .bg-switcher { gap: 6px !important; right: 6% !important; top: 74px !important; }
  .voicecontroltxtweb { font-size: 13px !important; padding: 6px 8px !important; height: 36px !important; }
}

@media (max-width: 420px) {
  .mic-button { width: 60px !important; height: 34px !important; }
  button, .banner-btn, .remove-btn, .ai_txt_sendbutton, .voicecontroltxtweb, .openbutt, .bg-switcher .banner-btn {
    font-size: 12px !important;
    padding: 5px 6px !important;
    height: 34px !important;
    border-radius: 6px !important;
    min-width: 36px !important;
  }
  .bg-switcher { right: 6% !important; top: 66px !important; }
  .voicecontroltxtweb { font-size: 12px !important; padding: 5px 6px !important; height: 34px !important; }
}

/* 預設：大螢幕隱藏語言選擇器和查看討論按鈕 */
select[aria-label="選擇語言"] { display: none !important; }

/* Mobile: move language select and "查看討論" button into a small floating right bar */
@media (max-width: 768px) {
  /* container-like visual for the floating bar (uses pseudo-background via both items) */
  /* hide original controls inside chat-input and instead show `.mobile-floating-controls` */
  .chat-input select[aria-label="選擇語言"] { display: none !important; }

  /* hide the large App-level voice control on mobile; we provide a compact one in the floating bar */
  /* (removed blanket hide to allow explicit control; see override at file end) */
  .chat-input .mic-button { display: none !important; }
  /* 預設：大螢幕隱藏語言選擇器 */ 

  select[aria-label="選擇語言"] {
    position: fixed !important;
    right: 12px !important;
    width: 60px !important;
    display: block !important;
    text-align: center !important;
    background: rgba(0,0,0,0.6) !important;
    color: #fff !important;
    border: 1px solid rgba(255,255,255,0.06) !important;
    box-shadow: 0 8px 24px rgba(0,0,0,0.45) !important;
    border-radius: 12px !important;
    padding: 6px 8px !important;
    z-index: 2200 !important;
  }
  /* Stack: language on top, discussion button under it (moved down slightly) */
  select[aria-label="選擇語言"] { top: 290px !important; }
  /* Make select's inner text smaller to fit */
  select[aria-label="選擇語言"] option { font-size: 12px !important; }
}

@media (max-width: 420px) {
  select[aria-label="選擇語言"] {
    width: 56px !important;
    right: 10px !important;
    padding: 5px 6px !important;
    border-radius: 10px !important;
  }
  select[aria-label="選擇語言"] { top: 255px !important; }
}

/* Ensure language select and discussion button are not affected by .chat-input touch/active effects */
@media (max-width: 768px) {
  select[aria-label="選擇語言"] {
    transform: none !important;
    box-shadow: none !important;
    transition: none !important;
  }
  select[aria-label="選擇語言"]:active, select[aria-label="選擇語言"]:focus {
    transform: none !important;
    box-shadow: none !important;
  }
  

/* Move bg-switcher to top-left on mobile to avoid overlap with right floating controls */
@media (max-width: 768px) {
  .bg-switcher {
    left: 8px !important;
    right: auto !important;
    top: 8px !important;
    gap: 6px !important;
    align-items: center !important;
    justify-content: flex-start !important;
  }
  .bg-switcher .banner-btn { padding: 6px 8px !important; font-size: 13px !important; }
}

@media (max-width: 420px) {
  .bg-switcher {
    left: -50% !important;
    right: auto !important;
    top: 6px !important;
    gap: 4px !important;
  }
  .bg-switcher .banner-btn { padding: 5px 6px !important; font-size: 12px !important; }
}
    outline: none !important;
  }

@media (max-width: 420px) {
  select[aria-label="選擇語言"] {
    transform: none !important;
    box-shadow: none !important;
    transition: none !important;
  }
  select[aria-label="選擇語言"]:active, select[aria-label="選擇語言"]:focus {
    transform: none !important;
    box-shadow: none !important;
    outline: none !important;
  }
}

/* On mobile place top-level voice control at top-left; desktop keeps original position */
@media (max-width: 768px) {
  .voicecontroltxtweb {
    display: inline-flex !important;
    left: 5% !important;
    top: 10% !important;
    right: auto !important;
    bottom: auto !important;
    position: fixed !important;
    z-index: 240 !important;
  }
}

/* Disable chat-input enlargement and keep input normal-size on mobile */
@media (max-width: 768px) {
  .chat-input:hover, .chat-input:active {
    transform: none !important;
    box-shadow: none !important;
  }
  /* Prevent txtinputplace from being enlarged on mobile */
  .txtinputplace {
    flex: 0 1 auto !important;
    min-width: 120px !important;
    font-size: 13px !important;
    padding: 6px 8px !important;
    height: 36px !important;
    border-radius: 8px !important;
  }
}

@media (max-width: 420px) {
  .chat-input:hover, .chat-input:active {
    transform: none !important;
    box-shadow: none !important;
  }
  .txtinputplace {
    flex: 0 1 auto !important;
    min-width: 100px !important;
    font-size: 12px !important;
    padding: 6px 6px !important;
    height: 34px !important;
    border-radius: 8px !important;
  }
}
